<section class="aq-panel" data-component="models-editor">
  <div class="aq-toolbar">
    <h2 style="margin:0">Settings</h2>
  </div>
  <div class="aq-content">
    <div class="aq-card" role="status" data-message="saved" style="display: none;"></div>
    <div class="aq-card" role="alert" data-message="error" style="border-color:#b91c1c;color:#fecaca;background:#450a0a; display: none;"></div>

    <div class="aq-form">
      <div class="aq-form-grid">
        <fieldset class="aq-card">
          <legend>Project</legend>
          <div class="aq-field-group">
            <div class="aq-card" style="margin:0;">
              <div><strong>Current:</strong> <span data-current-project>(none selected)</span></div>
            </div>
            <label class="aq-field" style="grid-column: span 2;">
              <span>Create new project (name only; will be created under projects/)</span>
              <input type="text" name="new_project_name" placeholder="my-story" />
            </label>
            <div>
              <button type="button" class="aq-btn" data-action="create-project">Create</button>
            </div>
          </div>
          <div class="aq-toolbar" style="justify-content: space-between; align-items: flex-start; gap:1rem; align-items: stretch;">
            <div style="text-align:right;">
              <div style="font-size:0.9rem; color:var(--muted); margin-bottom:0.25rem;">Available in projects/</div>
              <div data-project-list>
                <div class="aq-tip">No projects found under the built-in projects folder.</div>
              </div>
            </div>
          </div>
        </fieldset>

        <fieldset class="aq-card">
          <legend>Project (story) settings</legend>
          <label class="aq-field">
            <span>Project title</span>
            <input type="text" name="project_title" />
          </label>
          <label class="aq-field">
            <span>Format</span>
            <select name="format">
              <option value="markdown">Markdown</option>
              <option value="raw">Raw text</option>
            </select>
          </label>
          <label class="aq-field">
            <span>Chapters (one per line)</span>
            <textarea rows="6" name="chapters_text"></textarea>
          </label>
          <div class="aq-field-group">
            <label class="aq-field">
              <span>LLM Temperature</span>
              <input type="text" name="llm_temperature" />
            </label>
            <label class="aq-field">
              <span>Max tokens</span>
              <input type="text" name="llm_max_tokens" />
            </label>
          </div>
        </fieldset>

        <fieldset class="aq-card">
          <legend>Machine settings (OpenAI API compatible models)</legend>

          <div data-models-list>
            <!-- Models are rendered here by JS -->
          </div>

          <div data-name-issues class="aq-card" style="background:#450a0a;border-color:#b91c1c;color:#fecaca; display:none;">
            <!-- Name validation errors are shown here -->
          </div>

          <div class="aq-toolbar">
            <button type="button" class="aq-btn" data-action="add-model">Add model</button>
          </div>
        </fieldset>
      </div>

      <div class="aq-toolbar">
        <button type="button" class="aq-btn aq-btn-primary" data-action="save">Save</button>
        <button type="button" class="aq-btn" hx-get="/" hx-select="#main" hx-target="#main" hx-swap="innerHTML">Close</button>
      </div>
    </div>
  </div>
</section>

